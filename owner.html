<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>設定（オーナー）</title>

  <link rel="stylesheet" href="./ui.css?v=1">

  <style>
    /* ===== owner: layout safe ===== */
    .card{ overflow:hidden; } /* はみ出し防止 */
    .ownerBar{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; }

    /* messages */
    #msg{ white-space:pre-wrap; }

    /* ===== Toggle Switch ===== */
    .swRow{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
    .swLabel{ font-weight:1100; }

    .toggle{
      display:inline-flex;
      align-items:center;
      gap:10px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .toggle input{
      position:absolute;
      opacity:0;
      pointer-events:none;
    }
    .track{
      width:56px;
      height:34px;
      border-radius:999px;
      border:2px solid rgba(255,255,255,.35);
      background: rgba(0,0,0,.16);
      position:relative;
      box-shadow: 0 10px 22px rgba(0,0,0,.12);
      flex:0 0 auto;
    }
    .knob{
      position:absolute;
      top:50%;
      left:4px;
      transform: translateY(-50%);
      width:26px;
      height:26px;
      border-radius:999px;
      background:#fff;
      box-shadow: 0 8px 16px rgba(0,0,0,.18);
      transition: left .14s ease;
    }
    .toggle input:checked + .track{
      background: rgba(51,209,122,.22);
      border-color: rgba(51,209,122,.55);
    }
    .toggle input:checked + .track .knob{ left:26px; }

    .toggleText{
      font-weight:1100;
      padding:6px 10px;
      border-radius:999px;
      border:2px solid rgba(17,24,39,.12);
      background: rgba(255,255,255,.92);
      color:#111;
      white-space:nowrap;
    }
    .toggleText.on{
      background:#dbffe5;
      border-color:#1faa59;
      color:#111;
    }
    .toggleText.off{
      background:#ffe8c7;
      border-color:#f59e0b;
      color:#111;
    }

    /* ===== Table ===== */
    .tableWrap{ width:100%; overflow-x:auto; -webkit-overflow-scrolling:touch; }
    .ownerTable{ width:100%; border-collapse:collapse; margin-top:10px; min-width:780px; }
    .ownerTable th,.ownerTable td{
      border-bottom:1px dashed rgba(17,24,39,.12);
      padding:10px 8px;
      vertical-align:top;
    }
    .ownerTable th{ font-size:12px; opacity:.75; text-align:left; }
    .w120{ width:120px; }
    .w160{ width:160px; }

    /* inputs in table: never overflow */
    .ownerTable input{
      width:100%;
      min-width:0;
    }

    .rowbtn{ display:flex; gap:8px; flex-wrap:wrap; }

    /* ===== Mobile: table -> card rows (no overflow) ===== */
    @media (max-width: 760px){
      .tableWrap{ overflow:visible; }
      .ownerTable{ min-width:0; width:100%; display:block; }
      .ownerTable thead{ display:none; }
      .ownerTable tbody{ display:block; }
      .ownerTable tr{
        display:block;
        border:3px solid rgba(67,199,255,.22);
        border-radius:18px;
        padding:12px;
        margin:12px 0;
        background:#fff;
        box-shadow: 0 10px 22px rgba(0,0,0,.14);
      }
      .ownerTable td{
        display:block;
        border-bottom:none;
        padding:8px 0;
      }
      .cellLabel{
        display:block;
        font-size:12px;
        opacity:.75;
        margin-bottom:6px;
      }
      .rowbtn{ justify-content:flex-start; }
      .rowbtn .btn{ width:auto; }
      .ownerIdLine{
        font-weight:1100;
        font-size:16px;
        letter-spacing:.2px;
        margin-bottom:4px;
      }
    }
  </style>

  <script>
    window.GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzeeGTJKZXHsVEw8DMz_QahMsnbqAUzDM3D_9mnv1LpVRxIitpL0F3xlCTwKUjV0OURzQ/exec";
  </script>
</head>

<body>
  <header class="appHeader">
    <div class="wrap">
      <div class="headRow">
        <div class="brandTitle">OWNER</div>
        <nav class="topNav">
          <a class="navItem" href="./staff_handoff.html">受け渡し</a>
          <a class="navItem" href="./history.html">履歴</a>
          <a class="navItem" href="./sales.html">売上</a>
          <a class="navItem active" href="./owner.html">設定</a>
        </nav>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">

      <!-- 運用設定 -->
      <section class="card">
        <div class="sectionTitle" style="margin:0 0 10px;">運用設定</div>

        <div class="swRow">
          <span class="swLabel">注文受付</span>

          <label class="toggle toggleSold" style="position:relative;">
            <input class="soldToggle" type="checkbox" ...>
            <span class="track"><span class="knob"></span></span>
          </label>

          <!-- ✅ トグル（営業/閉店） -->
          <label class="toggle toggleShop" title="注文受付のON/OFF">
            <input id="ownerShopToggle" type="checkbox" />
            <span class="track"><span class="knob"></span></span>
          </label>


          <span id="ownerShopState" class="toggleText off">受付停止</span>
        </div>

        <div class="muted" style="margin-top:10px;">
          ※ 変更時に確認が出ます。切り替え履歴は下のログに残ります。
        </div>

        <div id="msg" class="msg" style="margin-top:12px;"></div>
      </section>

      <!-- 商品マスタ -->
      <section class="card">
        <div class="toolRow" style="padding:0;">
          <div class="toolLeft">
            <div class="sectionTitle" style="margin:0;">商品マスタ</div>
            <span class="muted">※ 価格・売切・表示順の編集ができます</span>
          </div>
          <div class="toolRight" style="justify-content:flex-end;">
            <button class="btn" id="btnReload">再読込</button>
            <button class="btn btnDanger" id="btnResetSoldOut">売切を全解除</button>
          </div>
        </div>

        <div class="tableWrap">
          <table class="ownerTable">
            <thead>
              <tr>
                <th class="w120">商品ID</th>
                <th>商品名</th>
                <th class="w120">価格</th>
                <th class="w120">表示順</th>
                <th class="w160">売切/販売中</th>
                <th class="w160">操作</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </section>

      <!-- 商品追加 / 更新 -->
      <section class="card">
        <div class="sectionTitle" style="margin:0 0 10px;">商品追加 / 更新</div>

        <div class="grid" style="gap:10px;">
          <div class="muted">説明</div><input id="add_desc" placeholder="説明">
          <div class="muted">画像URL</div><input id="add_img" placeholder="https://...">
          <div class="muted">動画URL</div><input id="add_vid" placeholder="https://...">
        </div>

        <div class="grid" style="grid-template-columns:160px 1fr; gap:10px; margin-top:10px;">
          <div class="muted">商品ID（必須）</div><input id="add_id" placeholder="例: P010">
          <div class="muted">商品名</div><input id="add_name" placeholder="例: トルネードポテト（塩）">
          <div class="muted">価格</div><input id="add_price" type="number" placeholder="例: 500">
          <div class="muted">表示順</div><input id="add_sort" type="number" placeholder="例: 10">
        </div>

        <div class="actions" style="justify-content:flex-start;">
          <button class="btn" id="btnAdd">保存（追加/更新）</button>
        </div>
      </section>

    </div>
  </main>

  <script src="./owner.js?v=2"></script>
</body>
</html>

